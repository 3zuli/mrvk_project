#include <mrvk_driver/Mb_status.h>
#include <mrvk_driver/Mcb_status.h>



#define QBAT 12000000.0
#define MBB12 0.008042
#define MBB1 0.004612
#define MBIB 0.0092929 // prud z baterie
#define MBT1 0.5
#define MCBIGM 0.0007446
#define MCB5V 0.005616
#define MCBUM 0.03742
#define MCBIM 0.01588

#define MBZISK1 12.0
#define MBNULPOL1 1811
#define MBZISK2 11.584
#define MBNULPOL2 3495

class Conversions{
public:

	Conversions();
	mrvk::Mb_status getStatusMB();
	mrvk::Mcb_status getStatusMCB(uint8_t device);

	double getSpeedLeftWheel();
	double getSpeedRightWheel();

	double getCameraPositionZ();
	double getCameraPositionX();

	const static int HEADER_LENGTH = 4;

	const static uint8_t HEADER = 0xFF;
	const static uint8_t MSG_OK = 0xFE;
	const static uint8_t MSG_ERROR = 0xFF;

	const static uint8_t LEFT_MOTOR = 0x05;
	const static uint8_t RIGHT_MOTOR = 0x06;
	const static uint8_t MAIN_BOARD = 0x03;


	static int16_t char2BToInt16(unsigned char H, unsigned char L);
	static uint32_t char4BToUint32(uint8_t HH, uint8_t H, uint8_t L, uint8_t LL);



protected:
	void convertMsg(uint8_t *data, uint8_t device);
//	const static double ODOMETRY_CONSTANT = 0.006546076617684;
	//const static double WHEEL_RADIUS = 0.115;

private:
	void answerMB_40_02(uint8_t *data);
	void answerMB_10(uint8_t *data);

	void answerMCB(uint8_t *data, uint8_t device);

	double speedWheels[2];

	double cameraPositionX;
	double cameraPositionZ;

	mrvk::Mb_status statusMB;
	mrvk::Mcb_status statusMCB[2]; //0 - lavy a 1 - pravy

};

